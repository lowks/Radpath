box: darron/wercker-ubuntu-14.04
build:
  steps:

      # Installing OS dependencies
      - script:
          name: Installing Ubuntu zip
          code: |
            sudo apt-get update
            sudo apt-get install zip
            
      - script:
          name: Adding Erlang repo
          code: |
            wget https://packages.erlang-solutions.com/erlang-solutions_1.0_all.deb && sudo dpkg -i erlang-solutions_1.0_all.deb
            
      - script: 
          name: Install esl Erlang
          code: |
            sudo apt-get update && sudo apt-get install esl-erlang
            
      - script:
          name: Install Elixir
          code: |
            sudo apt-get install elixir
            
      # Setting Environmental variables\
      - script:
          name: set env variable
          code: |
            export MIX_ENV=test
            
      - script:
          name: check elixir version
          code: |
            iex --version

      # Get dependencies.
      - script:
          name: Get Depedencies
          code: |
            cd $WERCKER_SOURCE_DIR
            yes | mix deps.get
            yes | mix deps.compile --all
            
      # Run the test
      - script:
            name: mix test
            code: |
              mix test
